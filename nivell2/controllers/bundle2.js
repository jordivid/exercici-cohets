!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);class n{constructor(t){this._maxpower=t}get maxpower(){return this._maxpower}}class o{constructor(t,e){this._codi=t,this._propulsors=new Array,this._curpower=0,this._posX=0,this._posY=0;for(let t of e)this._propulsors.push(new n(t))}static hasCohet(t,e){for(let r of e)if(r.codi===t)return!0;return!1}static getCohet(t,e){for(let r of e)if(r.codi===t)return r;return null}static eliminarCohet(t,e){for(let r=0;r<e.length;r++)if(e[r].codi===t){e.splice(r,1);break}this.serialitzar(e,"llista_cohets")}static serialitzar(t,e){sessionStorage.setItem(e,JSON.stringify(t))}static deserialitzar(t){let e=new Array,r=sessionStorage.getItem(t);if("string"==typeof r){let t,n=JSON.parse(r);for(t of n){let r=new Array;for(let e of t._propulsors)r.push(e._maxpower);e.push(new o(t._codi,r))}}return e}get codi(){return this._codi}get propulsors(){return this._propulsors}get curpower(){return this._curpower}get posX(){return this._posX}get posY(){return this._posY}set curpower(t){this._curpower=t}set posX(t){this._posX=t}set posY(t){this._posY=t}getMaxPower(){let t=0;for(let e of this.propulsors)t+=e.maxpower;return t}getImage(){return`rocket${this.propulsors.length}.png`}getInfo(){let t="",e=0;t+=`\n            <tr id="${this.codi}">\n            <td><button id="bt_${this.codi}" type="button" class="btn btn-sm btn-danger">X</button></td>\n            <td id="img_${this.codi}" class="p-1 d-flex flex-column align-items-center">\n                <img src="./../assets/${this.getImage()}" alt="Cohet" width="80px" height="auto">\n                <span style="font-size: 10px">${this.codi}</span>\n            </td>\n        `;for(let r of this.propulsors)e++,t+=`\n                <td class="text-center">${r.maxpower}</td>\n            `;if(e<6)for(let r=e;r<6;r++)t+="<td></td>";return t+="</tr>"}classified(t){let e="";return e+=`\n      <tr>\n      <td class="text-center"><span class="d-flex justify-content-center align-items-center" style="font-size: 30px">${t}</span></td>\n      <td id="img_${this.codi}" class="p-1 d-flex flex-column justify-content-center align-items-center">\n          <img src="./../assets/${this.getImage()}" alt="Cohet" width="80px" height="auto">\n          <span style="font-size: 10px">${this.codi}</span>\n      </td>\n      </tr>\n    `}accelerar(){const t=this.getMaxPower();let e=this.curpower;return e!==t&&((e+=o.ACC_FACTOR)>t&&(e=t),this.curpower=e,!0)}frenar(){let t=this.curpower;return 0!==t&&((t-=o.DEC_FACTOR)<0&&(t=0),this.curpower=t,!0)}aturar(){this.curpower=0}codiCohet(){return`\n            <div id="${this.codi}" style="display: inline-block; z-index: 100; position: absolute; top: -100px; left: -100px">\n                <img src="./../assets/${this.getImage()}" alt="${this.codi}">\n            </div>\n        `}}o.ACC_FACTOR=10,o.DEC_FACTOR=10;class i{constructor(t){this._competidors=new Map;for(let e of t)this._competidors.set(e,0);this._classificacio=new Array}finalCompeticio(){return this._competidors.size===this._classificacio.length&&(o.serialitzar(this.classificacio,"classificacio_cohets"),!0)}get classificacio(){return this._classificacio}getVoltes(t){let e=this._competidors.get(t);return void 0!==e?e:0}classificar(t){let e=this._competidors.get(t.codi);return void 0!==e&&(e++,this._competidors.set(t.codi,e),e===i.VOLTES)&&(this._classificacio.push(t),!0)}}i.VOLTES=Number(sessionStorage.getItem("voltes_cursa"));const s=100,l=window.innerHeight,c=window.innerWidth-100,d=Math.round((l-50)/s)-1;let a,u,p,f=null,m=new Array;function h(){let t,e=document.getElementById("btAccelerar"),r=document.getElementById("btFrenar"),n=document.getElementById("btIniciar"),o=document.getElementById("btAturar");clearInterval(p),f=null,e.setAttribute("disabled","true"),r.setAttribute("disabled","true"),o.setAttribute("disabled","true"),n.removeAttribute("disabled");for(let e=0;e<u&&e<d;e++)m[e].aturar(),m[e].posY=0,m[e].posX=20+e*s,(t=document.getElementById(m[e].codi)).style.left=`${m[e].posY}px`}window.addEventListener("load",t=>{var e,r,n,l,g;let b=document.getElementById("btAccelerar"),y=document.getElementById("btFrenar"),_=document.getElementById("btAturar");document.getElementById("btTornar");m=o.deserialitzar("llista_cohets"),a=document.getElementById("raceArea"),function(){u=m.length;let t,e=document.getElementById("codi"),r="";for(let n=0;n<u&&n<d;n++)r=`<option value="${m[n].codi}">${m[n].codi}</option>`,e.insertAdjacentHTML("beforeend",r),m[n].posY=0,m[n].posX=50+n*s,a.insertAdjacentHTML("beforeend",m[n].codiCohet()),(t=document.getElementById(m[n].codi)).style.top=`${m[n].posX}px`,t.style.left=`${m[n].posY}px`}(),b.setAttribute("disabled","true"),y.setAttribute("disabled","true"),_.setAttribute("disabled","true"),null===(e=document.getElementById("btIniciar"))||void 0===e||e.addEventListener("click",function(){!function(){let t=new Array,e=document.getElementById("btAccelerar"),r=document.getElementById("btFrenar"),n=document.getElementById("btIniciar"),o=document.getElementById("btAturar");e.removeAttribute("disabled"),r.removeAttribute("disabled"),o.removeAttribute("disabled"),n.setAttribute("disabled","true");for(let e=0;e<u&&e<d;e++)m[e].accelerar(),t.push(m[e].codi);f=new i(t),p=setInterval(function(){!function(){let t,e;for(let t=0;t<u&&t<d;t++)f.getVoltes(m[t].codi)<i.VOLTES&&(m[t].posY+=Math.round(m[t].curpower/5),m[t].posY>c&&(e=f.classificar(m[t]),m[t].posY=e?0:-100));for(let e=0;e<u&&e<d;e++)(t=document.getElementById(m[e].codi)).style.left=`${m[e].posY}px`;f.finalCompeticio()&&(h(),window.open("./../views/classificacio.html","_self"))}()},50)}()}),null===(r=document.getElementById("btAturar"))||void 0===r||r.addEventListener("click",function(){h()}),null===(n=document.getElementById("btAccelerar"))||void 0===n||n.addEventListener("click",function(){!function(){let t=document.getElementById("codi"),e=o.getCohet(t.value,m);null!=typeof e&&(null==e||e.accelerar())}()}),null===(l=document.getElementById("btFrenar"))||void 0===l||l.addEventListener("click",function(){!function(){let t=document.getElementById("codi"),e=o.getCohet(t.value,m);null!=typeof e&&e.curpower>10&&(null==e||e.frenar())}()}),null===(g=document.getElementById("btTornar"))||void 0===g||g.addEventListener("click",function(){!function(){!0===document.getElementById("btIniciar").disabled&&h();window.open("./../views/index.html","_self")}()})})}]);